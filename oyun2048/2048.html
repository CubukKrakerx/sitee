<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2048 Oyunu</title>
  <link rel="icon" href="dosyalar/resimler/asillogo.png" type="image/x-icon">
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #faf8ef;
      font-family: Arial, sans-serif;
      margin: 0;
      overflow: hidden;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(4, 100px);
      gap: 5px;
      position: relative;
    }

    .cell {
      width: 100px;
      height: 100px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
      color: #776e65;
      border-radius: 5px;
      transition: all 0.2s ease; /* Kayma ve renk animasyonu */
    }

    .message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 32px;
      font-weight: bold;
      color: red;
      display: none;
      background: white;
      padding: 15px 25px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>
  <div class="grid" id="grid">
    <div class="message" id="message">Kaybettin!</div>
  </div>

  <script>
    const gridElement = document.getElementById("grid");
    const messageElement = document.getElementById("message");
    let board = Array.from({length: 4}, () => Array(4).fill(0));

    function drawBoard() {
      gridElement.innerHTML = "";
      gridElement.appendChild(messageElement);
      board.forEach(row => {
        row.forEach(value => {
          const cell = document.createElement("div");
          cell.className = "cell";
          cell.innerText = value === 0 ? "" : value;
          cell.style.backgroundColor = getColor(value);
          gridElement.appendChild(cell);
        });
      });
    }

    function getColor(value) {
      switch (value) {
        case 0: return "#cdc1b4";
        case 2: return "#eee4da";
        case 4: return "#ede0c8";
        case 8: return "#f2b179";
        case 16: return "#f59563";
        case 32: return "#f67c5f";
        case 64: return "#f65e3b";
        case 128: return "#edcf72";
        case 256: return "#edcc61";
        case 512: return "#edc850";
        case 1024: return "#edc53f";
        case 2048: return "#edc22e";
        default: return "#3c3a32";
      }
    }

    function spawnTile() {
      const emptyCells = [];
      board.forEach((row, r) => {
        row.forEach((value, c) => {
          if (value === 0) emptyCells.push([r, c]);
        });
      });
      if (emptyCells.length > 0) {
        const [r, c] = emptyCells[Math.floor(Math.random() * emptyCells.length)];
        board[r][c] = Math.random() < 0.9 ? 2 : 4;
      }
    }

    function isGameOver() {
      for (let r = 0; r < 4; r++) {
        for (let c = 0; c < 4; c++) {
          if (board[r][c] === 0) return false;
          if (r < 3 && board[r][c] === board[r + 1][c]) return false;
          if (c < 3 && board[r][c] === board[r][c + 1]) return false;
        }
      }
      return true;
    }

    function moveTiles(direction) {
      let moved = false;

      const combine = (arr) => {
        const newRow = arr.filter(num => num);
        for (let i = 0; i < newRow.length - 1; i++) {
          if (newRow[i] === newRow[i + 1]) {
            newRow[i] *= 2;
            newRow[i + 1] = 0;
            moved = true;
          }
        }
        return newRow.filter(num => num);
      };

      const slide = (row) => {
        const newRow = combine(row);
        while (newRow.length < 4) newRow.push(0);
        return newRow;
      };

      if (direction === "left") {
        board.forEach((row, r) => {
          const newRow = slide(row);
          if (JSON.stringify(row) !== JSON.stringify(newRow)) moved = true;
          board[r] = newRow;
        });
      } else if (direction === "right") {
        board.forEach((row, r) => {
          const newRow = slide(row.reverse()).reverse();
          if (JSON.stringify(row) !== JSON.stringify(newRow)) moved = true;
          board[r] = newRow;
        });
      } else if (direction === "up") {
        for (let c = 0; c < 4; c++) {
          const col = [];
          for (let r = 0; r < 4; r++) col.push(board[r][c]);
          const newCol = slide(col);
          for (let r = 0; r < 4; r++) {
            if (board[r][c] !== newCol[r]) moved = true;
            board[r][c] = newCol[r];
          }
        }
      } else if (direction === "down") {
        for (let c = 0; c < 4; c++) {
          const col = [];
          for (let r = 3; r >= 0; r--) col.push(board[r][c]);
          const newCol = slide(col.reverse()).reverse();
          for (let r = 0; r < 4; r++) {
            if (board[r][c] !== newCol[r]) moved = true;
            board[r][c] = newCol[r];
          }
        }
      }

      return moved;
    }

    function handleMove(direction) {
      let moved = moveTiles(direction);
      if (moved) {
        spawnTile();
        drawBoard();
        if (isGameOver()) {
          messageElement.style.display = "block";
        }
      }
    }

    // Klavye desteği
    window.addEventListener("keydown", (event) => {
      if (event.key === "ArrowLeft") handleMove("left");
      if (event.key === "ArrowRight") handleMove("right");
      if (event.key === "ArrowUp") handleMove("up");
      if (event.key === "ArrowDown") handleMove("down");
    });

    // Dokunmatik destek
    let touchStartX = 0;
    let touchStartY = 0;

    window.addEventListener("touchstart", (e) => {
      const touch = e.touches[0];
      touchStartX = touch.clientX;
      touchStartY = touch.clientY;
    });

    window.addEventListener("touchend", (e) => {
      const touch = e.changedTouches[0];
      let dx = touch.clientX - touchStartX;
      let dy = touch.clientY - touchStartY;

      if (Math.abs(dx) > Math.abs(dy)) {
        if (dx > 50) handleMove("right");
        else if (dx < -50) handleMove("left");
      } else {
        if (dy > 50) handleMove("down");
        else if (dy < -50) handleMove("up");
      }
    });

    // Başlat
    spawnTile();
    spawnTile();
    drawBoard();
  </script>
</body>
</html>
