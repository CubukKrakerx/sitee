<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>2048 Oyunu</title>
  <link rel="icon" href="dosyalar/resimler/asillogo.png" type="image/x-icon">
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #faf8ef;
      font-family: Arial, sans-serif;
      overflow: hidden;
      touch-action: none; /* Mobilde sayfanın kaymasını engeller */
    }

    .board {
      position: relative;
      width: 420px;
      height: 420px;
      background: #bbada0;
      border-radius: 10px;
      display: grid;
      grid-template-columns: repeat(4, 100px);
      grid-template-rows: repeat(4, 100px);
      gap: 5px;
      padding: 5px;
    }

    .cell {
      width: 100px;
      height: 100px;
      background: #cdc1b4;
      border-radius: 5px;
    }

    .tile {
      position: absolute;
      width: 100px;
      height: 100px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      font-weight: bold;
      border-radius: 5px;
      transition: transform 0.2s ease, background-color 0.2s ease;
    }

    .message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 32px;
      font-weight: bold;
      color: red;
      display: none;
      background: white;
      padding: 15px 25px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 10;
    }
  </style>
</head>
<body>
  <div class="board" id="board">
    <div class="message" id="message">Kaybettin!</div>
    <!-- Grid arka plan hücreleri -->
    <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
    <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
    <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
    <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
  </div>

  <script>
    const boardElement = document.getElementById("board");
    const messageElement = document.getElementById("message");
    let board = Array.from({length: 4}, () => Array(4).fill(0));

    function getColor(value) {
      switch (value) {
        case 2: return "#eee4da";
        case 4: return "#ede0c8";
        case 8: return "#f2b179";
        case 16: return "#f59563";
        case 32: return "#f67c5f";
        case 64: return "#f65e3b";
        case 128: return "#edcf72";
        case 256: return "#edcc61";
        case 512: return "#edc850";
        case 1024: return "#edc53f";
        case 2048: return "#edc22e";
        default: return "#3c3a32";
      }
    }

    function drawBoard() {
      document.querySelectorAll(".tile").forEach(t => t.remove());
      for (let r = 0; r < 4; r++) {
        for (let c = 0; c < 4; c++) {
          let value = board[r][c];
          if (value !== 0) {
            const tile = document.createElement("div");
            tile.className = "tile";
            tile.innerText = value;
            tile.style.backgroundColor = getColor(value);
            tile.style.transform = `translate(${c*105}px, ${r*105}px)`;
            boardElement.appendChild(tile);
          }
        }
      }
    }

    function spawnTile() {
      const emptyCells = [];
      board.forEach((row, r) => {
        row.forEach((v, c) => {
          if (v === 0) emptyCells.push([r, c]);
        });
      });
      if (emptyCells.length > 0) {
        const [r, c] = emptyCells[Math.floor(Math.random() * emptyCells.length)];
        board[r][c] = Math.random() < 0.9 ? 2 : 4;
      }
    }

    function isGameOver() {
      for (let r = 0; r < 4; r++) {
        for (let c = 0; c < 4; c++) {
          if (board[r][c] === 0) return false;
          if (r < 3 && board[r][c] === board[r+1][c]) return false;
          if (c < 3 && board[r][c] === board[r][c+1]) return false;
        }
      }
      return true;
    }

    function slide(row) {
      row = row.filter(v => v);
      for (let i = 0; i < row.length - 1; i++) {
        if (row[i] === row[i+1]) {
          row[i] *= 2;
          row[i+1] = 0;
        }
      }
      row = row.filter(v => v);
      while (row.length < 4) row.push(0);
      return row;
    }

    function moveTiles(dir) {
      let moved = false;
      if (dir === "left") {
        for (let r = 0; r < 4; r++) {
          let newRow = slide(board[r]);
          if (board[r].toString() !== newRow.toString()) moved = true;
          board[r] = newRow;
        }
      } else if (dir === "right") {
        for (let r = 0; r < 4; r++) {
          let newRow = slide(board[r].slice().reverse()).reverse();
          if (board[r].toString() !== newRow.toString()) moved = true;
          board[r] = newRow;
        }
      } else if (dir === "up") {
        for (let c = 0; c < 4; c++) {
          let col = [board[0][c], board[1][c], board[2][c], board[3][c]];
          let newCol = slide(col);
          for (let r = 0; r < 4; r++) {
            if (board[r][c] !== newCol[r]) moved = true;
            board[r][c] = newCol[r];
          }
        }
      } else if (dir === "down") {
        for (let c = 0; c < 4; c++) {
          let col = [board[3][c], board[2][c], board[1][c], board[0][c]];
          let newCol = slide(col).reverse();
          for (let r = 0; r < 4; r++) {
            if (board[r][c] !== newCol[r]) moved = true;
            board[r][c] = newCol[r];
          }
        }
      }
      return moved;
    }

    function handleMove(dir) {
      if (moveTiles(dir)) {
        spawnTile();
        drawBoard();
        if (isGameOver()) {
          messageElement.style.display = "block";
        }
      }
    }

    // Klavye
    window.addEventListener("keydown", e => {
      if (e.key === "ArrowLeft") handleMove("left");
      if (e.key === "ArrowRight") handleMove("right");
      if (e.key === "ArrowUp") handleMove("up");
      if (e.key === "ArrowDown") handleMove("down");
    });

    // Dokunmatik
    let startX, startY;
    window.addEventListener("touchstart", e => {
      startX = e.touches[0].clientX;
      startY = e.touches[0].clientY;
    });
    window.addEventListener("touchend", e => {
      let dx = e.changedTouches[0].clientX - startX;
      let dy = e.changedTouches[0].clientY - startY;
      if (Math.abs(dx) > Math.abs(dy)) {
        if (dx > 50) handleMove("right");
        else if (dx < -50) handleMove("left");
      } else {
        if (dy > 50) handleMove("down");
        else if (dy < -50) handleMove("up");
      }
    });

    // Başlat
    spawnTile();
    spawnTile();
    drawBoard();
  </script>
</body>
</html>
