<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2048 Oyunu</title>
    <link rel="icon" href="dosyalar/resimler/asillogo.png" type="image/x-icon">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #faf8ef;
            font-family: Arial, sans-serif;
            overflow: hidden; /* Kaydırma çubuğunu gizler */
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(4, 100px);
            gap: 5px;
            position: relative; /* Göreceli konumlandırma */
        }
        .cell {
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            color: #776e65;
            border-radius: 5px;
            transition: transform 0.2s ease, background-color 0.2s ease; /* Animasyon efekti */
        }
        .message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 32px;
            font-weight: bold;
            color: red;
            display: none; /* Varsayılan olarak gizli */
        }
    </style>
</head>
<body>
    <div class="grid" id="grid">
        <div class="message" id="message">Kaybettin!</div>
    </div>
    <script>
        const gridElement = document.getElementById("grid");
        const messageElement = document.getElementById("message");
        let board = Array.from({length: 4}, () => Array(4).fill(0));

        function drawBoard() {
            gridElement.innerHTML = "";
            gridElement.appendChild(messageElement); // Mesaj elemanını tekrar ekle
            board.forEach(row => {
                row.forEach(value => {
                    const cell = document.createElement("div");
                    cell.className = "cell";
                    cell.innerText = value === 0 ? "" : value;
                    cell.style.backgroundColor = getColor(value); // Renk ataması
                    gridElement.appendChild(cell);
                });
            });
        }

        function getColor(value) {
            switch (value) {
                case 0: return "#eee4da";
                case 2: return "#ede0c8";
                case 4: return "#f2b179";
                case 8: return "#f59563";
                case 16: return "#f67c5f";
                case 32: return "#f67c5f";
                case 64: return "#f67c5f";
                case 128: return "#f9e79f";
                case 256: return "#f7dc6f";
                case 512: return "#f4d03f";
                case 1024: return "#f39c12";
                case 2048: return "#e67e22";
                default: return "#c7c9c7"; // Diğer durumlar için varsayılan renk
            }
        }

        function spawnTile() {
            const emptyCells = [];
            board.forEach((row, r) => {
                row.forEach((value, c) => {
                    if (value === 0) emptyCells.push([r, c]);
                });
            });
            if (emptyCells.length > 0) {
                const [r, c] = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                board[r][c] = Math.random() < 0.9 ? 2 : 4;
            }
        }

        function isGameOver() {
            for (let r = 0; r < 4; r++) {
                for (let c = 0; c < 4; c++) {
                    if (board[r][c] === 0) return false; // Boş hücre varsa oyun bitmez
                    if (r < 3 && board[r][c] === board[r + 1][c]) return false; // Aşağıdaki hücre ile eşitse
                    if (c < 3 && board[r][c] === board[r][c + 1]) return false; // Yanındaki hücre ile eşitse
                }
            }
            return true; // Oyun bitti
        }

        function moveTiles(direction) {
            let moved = false;

            const combine = (arr) => {
                const newRow = arr.filter(num => num);
                for (let i = 0; i < newRow.length - 1; i++) {
                    if (newRow[i] === newRow[i + 1]) {
                        newRow[i] *= 2;
                        newRow[i + 1] = 0;
                        moved = true;
                    }
                }
                return newRow.filter(num => num);
            };

            const slide = (row) => {
                const newRow = combine(row);
                while (newRow.length < 4) newRow.push(0);
                return newRow;
            };

            const animateSlide = (row, r, direction) => {
                const cells = [...row];
                for (let i = 0; i < 4; i++) {
                    const cell = gridElement.children[r * 4 + i];
                    if (cells[i] !== 0) {
                        cell.style.transform = direction === "left" ? "translateX(-100%)" : 
                                               direction === "right" ? "translateX(100%)" : 
                                               direction === "up" ? "translateY(-100%)" : 
                                               "translateY(100%)";
                    }
                }
                setTimeout(() => {
                    for (let i = 0; i < 4; i++) {
                        const cell = gridElement.children[r * 4 + i];
                        cell.style.transform = "translateX(0)";
                    }
                }, 200);
            };

            if (direction === "left") {
                board.forEach((row, r) => {
                    const newRow = slide(row);
                    if (JSON.stringify(row) !== JSON.stringify(newRow)) {
                        moved = true;
                        animateSlide(row, r, "left");
                    }
                    board[r] = newRow;
                });
            } else if (direction === "right") {
                board.forEach((row, r) => {
                    const newRow = slide(row.reverse()).reverse();
                    if (JSON.stringify(row) !== JSON.stringify(newRow)) {
                        moved = true;
                        animateSlide(row, r, "right");
                    }
                    board[r] = newRow;
                });
            } else if (direction === "up") {
                for (let c = 0; c < 4; c++) {
                    const newCol = [];
                    for (let r = 0; r < 4; r++) {
                        newCol.push(board[r][c]);
                    }
                    const newRow = slide(newCol);
                    for (let r = 0; r < 4; r++) {
                        board[r][c] = newRow[r];
                    }
                }
                moved = true;
            } else if (direction === "down") {
                for (let c = 0; c < 4; c++) {
                    const newCol = [];
                    for (let r = 3; r >= 0; r--) {
                        newCol.push(board[r][c]);
                    }
                    const newRow = slide(newCol.reverse()).reverse();
                    for (let r = 0; r < 4; r++) {
                        board[r][c] = newRow[r];
                    }
                }
                moved = true;
            }

            return moved;
        }

        function handleInput(event) {
            let moved = false;
            if (event.key === "ArrowLeft") {
                moved = moveTiles("left");
            } else if (event.key === "ArrowRight") {
                moved = moveTiles("right");
            } else if (event.key === "ArrowUp") {
                moved = moveTiles("up");
            } else if (event.key === "ArrowDown") {
                moved = moveTiles("down");
            }
            if (moved) {
                spawnTile();
                drawBoard();
                if (isGameOver()) {
                    messageElement.style.display = "block"; // Kaybettin mesajını göster
                }
            }
            event.preventDefault(); // Tarayıcı kaydırmasını engeller
        }

        spawnTile();
        spawnTile();
        drawBoard();

        window.addEventListener("keydown", handleInput);
    </script>
</body>
</html>
